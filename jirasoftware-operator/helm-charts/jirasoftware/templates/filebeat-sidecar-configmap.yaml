{{- if .Values.filebeat.enabled }}
kind: ConfigMap
apiVersion: v1
metadata:
  name: {{ .Release.Name }}-filebeat
data:
  filebeat.yml: |-
    #=========================== Filebeat inputs =============================

    filebeat.inputs:

    {{- range $logConfig := .Values.filebeat.logConfig }}
    - type: log
      enabled: true
      paths:
        {{- range $logConfig.logPaths }}
        - {{ . }}
        {{- end }}
      {{- toYaml $logConfig.logParams | nindent 6 }}
    {{ end }}

    #================================ Outputs =====================================
    output.logstash:
      hosts: [{{ .Values.filebeat.logstashHost | quote }}]

    #================================ Processors =====================================

    # Configure processors to enhance or manipulate events generated by the beat.

    processors:
      - add_host_metadata: ~
      - add_cloud_metadata: ~
{{- end }}